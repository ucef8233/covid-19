const questions = document.querySelector(".questions");
const repon = document.querySelector(".reponces");
const suivant = document.getElementById("suivant");
const precedent = document.getElementById("precedent");
const demarage = document.getElementById("demarer");
const resultat = document.getElementById("resultat");
const sect = document.querySelectorAll(".sect");
let i = 0;
var oplalla;
var blan = ["34", "18", "50", "140"];

window.onload = () => {
  for (let i = 0; i < sect.length; i++) {
    demarage.addEventListener("click", function () {
      sect[i].classList.toggle("affiche");
      precedent.classList.add("affiche");
      questions.innerHTML = Question[0];
      choix = document.querySelector(".questions p").className;
      choisReponce();
      tcheecked();
    });
  }
  Qsuivante();
  Qprecedente();
};
Qsuivante = () => {
  suivant.addEventListener("click", function (e) {
    reponces = document.querySelectorAll("#form__choice");
    precedent.classList.remove("affiche");
    if (i >= 0 && i < Question.length - 1) {
      i++;
    }
    if (i == Question.length - 1) {
      suivant.classList.add("affiche");
      resultat.classList.remove("affiche");
    }
    questions.innerHTML = Question[i];
    choix = document.querySelector(".questions p").className;
    e.preventDefault();
    choisReponce();
    tcheecked();
    tcheeckedtext();
  });
};

Qprecedente = () => {
  precedent.addEventListener("click", function (e) {
    suivant.classList.remove("affiche");
    resultat.classList.add("affiche");
    if (i > 0) {
      i--;
    }
    if (i == 0) {
      precedent.classList.add("affiche");
    }

    questions.innerHTML = Question[i];
    choix = document.querySelector(".questions p").className;
    e.preventDefault();
    choisReponce();
    tcheecked();
    tcheeckedtext();
  });
};
choisReponce = () => {
  switch (choix) {
    case "form__question--c":
      repon.innerHTML = rep[0].c;
      case0();
      break;
    case "form__question--age":
      repon.innerHTML = rep[0].age;
      case0();
      break;
    case "form__question--poids":
      repon.innerHTML = rep[0].poids;
      case0();
      break;
    case "form__question--taille":
      repon.innerHTML = rep[0].taille;
      case0();
      break;
    case "form__question":
      repon.innerHTML = rep[1];
      spliceReponce(1);
      break;
    case "form__question--trois":
      repon.innerHTML = rep[2];
      spliceReponce(2);
      break;
    case "form__question--quatre":
      repon.innerHTML = rep[3];
      spliceReponce(3);
      break;
  }
};

spliceReponce = (e) => {
  reponces = document.querySelectorAll("#form__choice");
  if (info[i] == undefined) {
    info.splice(i, 1, tabRe[e][0]);
  } else {
    info.splice(i, 1, info[i]);
  }

  for (let k = 0; k < reponces.length; k++) {
    reponces[k].addEventListener("click", function () {
      if (reponces[k].checked) {
        info.splice(i, 1, tabRe[e][k]);
      }
    });
  }
};
tcheecked = () => {
  if (info[i] == "Oui" || info[i] == "Bien") {
    reponces[0].setAttribute("checked", "checked");
  } else if (info[i] == "Non" || info[i] == "Assez bien") {
    reponces[1].setAttribute("checked", "checked");
  } else if (info[i] == "Homme" || info[i] == "Fatigué") {
    reponces[2].setAttribute("checked", "checked");
  } else if (info[i] == "Très fatigué") {
    reponces[3].setAttribute("checked", "checked");
  }
};
case0 = () => {
  reponces = document.querySelectorAll("#form__choice");
  oplalla = document.getElementById("reponce1");
  // for (let k = 0; k < 4; k++) {
  oplalla.addEventListener("change", function (e) {
    info.splice(i, 1, e.target.value);
    switch (choix) {
      case "form__question--c":
        blan.splice(0, 1, e.target.value);
        break;
      case "form__question--age":
        blan.splice(1, 1, e.target.value);
        break;
      case "form__question--poids":
        blan.splice(2, 1, e.target.value);
        break;
      case "form__question--taille":
        blan.splice(3, 1, e.target.value);
        break;
    }
  });
  if (oplalla.value == "") {
    switch (choix) {
      case "form__question--c":
        info.splice(i, 1, blan[0]);
        break;
      case "form__question--age":
        info.splice(i, 1, blan[1]);
        break;
      case "form__question--poids":
        info.splice(i, 1, blan[2]);
        break;
      case "form__question--taille":
        info.splice(i, 1, blan[3]);
        break;
    }
  }
  // }
};
tcheeckedtext = () => {
  oplalla = document.getElementById("reponce1");
  if (reponces.length == 0) {
    switch (choix) {
      case "form__question--c":
        oplalla.value = blan[0];
        break;
      case "form__question--age":
        oplalla.value = blan[1];
        break;
      case "form__question--poids":
        oplalla.value = blan[2];
        break;
      case "form__question--taille":
        oplalla.value = blan[3];
        break;
    }
  }
};

resultat js////////////////:
let facteurPronostique = [];
let facteurMineur = [];
let facteurMajeur = [];
let affichageRes = document.getElementById("affichageResult");
triReponces = () => {
  for (let i = 0; i < info.length; i++) {
    if (i == 1) {
      facteurMineur.push(info[i]);
      facteurMajeur.push(info[i]);
    } else if (i >= 11 && i <= 21) {
      facteurPronostique.push(info[i]);
    } else if (i == 7 || i == 8) {
      facteurMajeur.push(info[i]);
    } else if (i == 6 || i == 9) {
      facteurMineur.push(info[i]);
    }
  }
};
var resultatPronostique = 0;
var resultatMineur = 0;
var resultatMajeur = 0;
trifacteur = () => {
  for (let i = 0; i < facteurPronostique.length; i++) {
    if (facteurPronostique[i] == "Oui") {
      resultatPronostique++;
    }
  }
  for (let i = 0; i < facteurMineur.length; i++) {
    if (
      facteurMineur[i] >= 39.7 ||
      facteurMineur[i] == "Oui" ||
      facteurMineur[i] == "Fatigué" ||
      facteurMineur[i] == "Très fatigué"
    ) {
      resultatMineur++;
    }
  }
  for (let i = 0; i < facteurMajeur.length; i++) {
    if (facteurMajeur[i] <= 35.4 || facteurMajeur[i] == "Oui") {
      resultatMajeur++;
    }
  }
};
let wayeh = () => {
  if (info[10] < 15) {
    affichageRes.innerHTML = tabresult.ans15;
  }
  if (
    info[0] == "Oui" ||
    (info[2] == "Oui" && info[4] == "Oui") ||
    (info[2] == "Oui" && info[3] == "Oui") ||
    (info[0] == "Oui" && info[5] == "Oui")
  ) {
    ///Patient avec fièvre, ou toux + mal de gorge, ou toux + courbatures ou fièvre + diarrhée :
    if (resultatPronostique == 0 && resultatMajeur == 0) {
      ////Tout patient sans facteur pronostique :
      if (resultatMineur == 0 && info[10] < 50) {
        ////Sans facteur de gravité & <50 ans :
        affichageRes.innerHTML = tabresult.sans;
      } else if (
        //////Sans facteur de gravité & 50-69 ans, ou avec au moins un facteur de gravité mineur :
        resultatMineur <= 3 &&
        info[10] >= 50 &&
        info[10] <= 69
      ) {
        affichageRes.innerHTML = tabresult.resultat3;
      }
    // } else {
    //   ////Tout patient avec un facteur pronostique ou plus : -----a regrouper 2-----
    //   if (resultatMineur <= 1 && resultatMajeur == 0) {
    //     ///Aucun facteur de gravité || Un seul facteur de gravité mineur  -----a regrouper 2-----
    //     affichageRes.innerHTML = tabresult.resultat3;
    //   } else if (resultatMineur >= 2 || resultatMajeur == 0) {
    //     ////Au moins deux facteurs de gravité mineurs  (((((((((((a regrouper1)))))))))))
    //     affichageRes.innerHTML = tabresult.resultat4;
    //   }
    // }
  }
  if (
    info[0] == "Oui" ||
    (info[2] == "Oui" && info[4] == "Oui") ||
    (info[2] == "Oui" && info[3] == "Oui") ||
    (info[0] == "Oui" && info[5] == "Oui") ||
    (info[0] == "Oui" && info[2] == "Oui")
  ) {
    if (resultatPronostique == 0) {
      if (resultatMajeur == 0 && resultatMineur <= 1) {
        ///Aucun facteur de gravité ||Un seul facteur de gravité mineur  -----a regrouper 2-----
        affichageRes.innerHTML = tabresult.resultat3;
      } else if (resultatMajeur == 0 && resultatMineur >= 2) {
        ///// Au moins deux facteurs de gravité mineurs (((((((((((a regrouper1)))))))))))
        affichageRes.innerHTML = tabresult.resultat4;
      }
    }
  }
    if (info[0] == "Oui" && info[2] == "Oui") {
      ///// avec fievre et toux
      if (resultatPronostique == 0) {
        ///Tout patient sans facteur pronostique :
        if (resultatMajeur == 0 && resultatMineur >= 1) {
          ///Sans facteur de gravité ou au moins 1 facteur de gravité mineur sans facteur de gravité majeur
          affichageRes.innerHTML = tabresult.resultat3;
        }
      // } else {
      //   ///Tout patient avec un facteur pronostique ou plus :  -----a regrouper 2-----
      //   if (resultatMajeur == 0 && resultatMineur <= 1) {
      //     ///Aucun facteur de gravité ||Un seul facteur de gravité mineur  -----a regrouper 2-----
      //     affichageRes.innerHTML = tabresult.resultat3;
      //   } else if (resultatMajeur == 0 && resultatMineur >= 2) {
      //     ///// Au moins deux facteurs de gravité mineurs (((((((((((a regrouper1)))))))))))
      //     affichageRes.innerHTML = tabresult.resultat4;
      //   }
      // }
    }
  if (
    info[0] == "Oui" ||
    info[2] == "Oui" ||
    info[3] == "Oui" ||
    info[4] == "Oui"
  ) {
    ///Tout patient avec un seul symptôme parmi fièvre, toux, mal de gorge, courbatures :
    if (resultatPronostique == 0) {
      /////Pas de facteur de gravité :
      affichageRes.innerHTML = tabresult.resultat5;
    } else if (
      resultatPronostique == 0 &&
      (resultatMajeur > 0 || resultatMineur > 0)
    ) {
      /////Au moins un facteur de gravité ou un facteur pronostique :
      affichageRes.innerHTML = tabresult.resultat5;
      affichageRes.innerHTML = tabresult.resultat4;
    }
  }
};
let resFinal = () => {
  resultat.addEventListener("click", function (e) {
    sect[1].classList.add("affiche");
    sect[2].classList.remove("affiche");
    triReponces(info);
    trifacteur();
    wayeh();
    e.preventDefault();
  });
};


